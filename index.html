<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PixelBatch ‚Äî Bulk Image Renamer & Resizer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <main class="app">
    <section class="card">

      <!-- Manifesto -->
      <div class="global-statement">
        <strong>No sign-ups. No limits. No bullshit.</strong>
        <span>
          Runs 100% on your machine ‚Äî not some greedy site charging you money
          for using <em>your own hardware</em>.
        </span>
      </div>

      <!-- Top bar -->
      <header class="topbar">
        <div class="brand">
          <div class="brand-mark">PB</div>
          <div>
            <h1 class="brand-title">PixelBatch</h1>
            <p class="brand-subtitle">Bulk rename & resize ‚Äî right in your browser.</p>
          </div>
        </div>

        <div class="topbar-right">
          <span class="pill pill-soft">100% offline</span>
          <span class="pill pill-outline">MIT open source</span>

          <button type="button" id="themeToggle" class="pill pill-button">
            <span class="theme-icon" data-theme-icon="dark">üåô</span>
            <span class="theme-icon" data-theme-icon="light" style="display:none;">‚òÄÔ∏è</span>
            <span class="theme-label">Dark</span>
          </button>
        </div>
      </header>

      <!-- Upload -->
      <section class="card-section">
        <label class="dropzone">
          <div class="dropzone-icon">‚¨ÜÔ∏è</div>
          <div class="dropzone-text">
            <strong>Drop images here</strong> or <span class="linkish">browse</span>
          </div>
          <div class="dropzone-sub">PNG, JPG, WEBP ¬∑ Multiple files</div>
          <input type="file" id="fileInput" accept="image/*" multiple />
        </label>
      </section>

      <!-- Naming -->
      <section class="card-section card-section-bordered">
        <div class="section-header">
          <h2 class="section-title">Naming</h2>
          <p class="section-help">Control output filenames.</p>
        </div>

        <div class="grid two-cols">
          <label class="field">
            <span class="field-label">Name prefix</span>
            <input type="text" id="namePattern" value="image_" />
          </label>

          <label class="field">
            <span class="field-label">Start index</span>
            <input type="number" id="startIndex" value="1" />
          </label>
        </div>
      </section>

      <!-- Resize -->
      <section class="card-section">
        <div class="section-header">
          <h2 class="section-title">Resize</h2>
          <p class="section-help">Leave empty to keep original size.</p>
        </div>

        <div class="grid two-cols">
          <label class="field">
            <span class="field-label">Width (px)</span>
            <input type="number" id="widthInput" />
          </label>

          <label class="field">
            <span class="field-label">Height (px)</span>
            <input type="number" id="heightInput" />
          </label>
        </div>

        <label class="checkbox">
          <input type="checkbox" id="keepAspect" checked />
          <span>Keep aspect ratio</span>
        </label>

        <div class="preset-row">
          <span class="preset-label">Presets:</span>
          <button class="chip" data-preset="512">512√ó512</button>
          <button class="chip" data-preset="1024">1024√ó1024</button>
          <button class="chip" data-preset="1280x720">1280√ó720</button>
        </div>
      </section>

      <!-- Actions -->
      <section class="card-section actions">
        <div class="actions-left">
          <button id="processBtn" class="btn primary">Process images</button>
          <button id="downloadAllBtn" class="btn" disabled>Download ZIP</button>
        </div>
        <div class="actions-right">
          <button id="clearBtn" class="btn subtle">Clear</button>
        </div>
      </section>

      <!-- Preview -->
      <section class="card-section">
        <div class="section-header">
          <h2 class="section-title">Preview</h2>
        </div>
        <div id="previewList" class="preview-grid"></div>
      </section>

      <!-- Footer -->
      <footer class="card-footer">
        <div class="footer-row">
          <span class="footer-text">Made with vanilla JS ¬∑ MIT Licensed</span>
        </div>
      </footer>

    </section>
  </main>

  <!-- Hidden canvas -->
  <canvas id="hiddenCanvas" style="display:none;"></canvas>

  <!-- Toast -->
  <div id="easterEggToast" class="toast"></div>

  <!-- Scripts -->
  <script src="libs/jszip.min.js"></script>
  <script src="script.js"></script>

  <script>
    // ===== THEME =====
    const themeToggle = document.getElementById("themeToggle");
    const darkIcon = themeToggle.querySelector('[data-theme-icon="dark"]');
    const lightIcon = themeToggle.querySelector('[data-theme-icon="light"]');
    const themeLabel = themeToggle.querySelector(".theme-label");

    function applyTheme(theme) {
      document.body.classList.toggle("theme-light", theme === "light");
      document.body.classList.toggle("theme-dark", theme !== "light");
      darkIcon.style.display = theme === "light" ? "none" : "";
      lightIcon.style.display = theme === "light" ? "" : "none";
      themeLabel.textContent = theme === "light" ? "Light" : "Dark";
    }

    applyTheme(localStorage.getItem("pixelbatch-theme") || "dark");

    themeToggle.onclick = () => {
      const next = document.body.classList.contains("theme-light") ? "dark" : "light";
      applyTheme(next);
      localStorage.setItem("pixelbatch-theme", next);
    };

    // ===== TOAST =====
    const toast = document.getElementById("easterEggToast");
    let toastTimer;

    function showToast(msg) {
      toast.textContent = msg;
      toast.classList.add("show");
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => toast.classList.remove("show"), 3000);
    }

    // ===== EASTER EGGS =====

    // Logo click x5
    const brand = document.querySelector(".brand-mark");
    let clicks = 0, t;

    brand.onclick = () => {
      clicks++;
      clearTimeout(t);
      t = setTimeout(() => clicks = 0, 1000);
      if (clicks === 5) {
        clicks = 0;
        showToast("üñï Fuck paywalled image tools. This one stays free and local.");
      }
    };

    // Type "pixel"
    const seq = ["p","i","x","e","l"];
    let buf = [];

    window.addEventListener("keydown", e => {
      if (e.key.length !== 1) return;
      buf.push(e.key.toLowerCase());
      if (buf.length > seq.length) buf.shift();
      if (seq.every((c,i)=>c===buf[i])) {
        showToast("üê∞ Open-source or nothing. Fuck closed-source crap.");
      }
    });
  </script>
</body>
</html>
